<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>海报设置</title>
    <link rel="stylesheet" href="../../css/font-awesome.css?v=4.4.1" >
    <link rel="stylesheet" href="../../js/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../js/layui/css/layer.css">
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body id="chutiyan">


<div class="page-title">海报设置</div>
<div class="activity_set activity_set3 w-6">
    <div class="b-line" style="border-bottom: 0">
        <div class="a_list">
            <span class="a_list_l">海报链接:</span>
            <div class="a_list_r">http：lkm.huoma.com<span class="copy-btn">复制</span></div>
        </div>
        <div class="a_list">
            <span class="a_list_l">海报设置:</span>
            <div class="a_list_r">
                设置分享海报，用户通过扫描海报上的二维码访问活码页面
            </div>
        </div>
        <div class="a_list">
            <span class="a_list_l"></span>
            <div class="a_list_r">
                <div class="poster">
                    <div id='poster' style="width: 300px;min-width: 300px;margin-right: 40px;height: 640px;border:1px solid #d5d5d5;position:relative;z-index: 1;overflow: hidden;">
                        <img src='' class='bg' id="Img" style="width:100%;height: 100%;z-index:0;object-fit: contain" alt=""/>
                        <div class="drag u_pic" type="head" index="3" style="z-index:3;left:20px;top:20px;width:60px;height:60px;position: absolute">
                            <img src="../../images/head.jpg" style="width:100%;height: 100%;"/>
                            <div class="rRightDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;right:-4px;bottom:-4px;"></div>
                            <div class="rLeftDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;left:-4px;bottom:-4px;"></div>
                            <div class="rRightUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;right:-4px;top:-4px;"></div>
                            <div class="rLeftUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;left:-4px;top:-4px;"></div>
                            <div class="rRight" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;right:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rLeft" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;left:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;top:-4px;left:50%;margin-left:-4px;"></div>
                            <div class="rDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;bottom:-4px;left:50%;margin-left:-4px;"></div>
                        </div>
                        <div class="drag u_name" id="u_name" type="realname" index="4" style="z-index:4;right:20px;top:20px;width:60px;height:21px;position: absolute">
                            <div class="text" style="font-size: 12px;">昵称</div>
                            <div class="rRightDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;right:-4px;bottom:-4px;"></div>
                            <div class="rLeftDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;left:-4px;bottom:-4px;"></div>
                            <div class="rRightUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;right:-4px;top:-4px;"></div>
                            <div class="rLeftUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;left:-4px;top:-4px;"></div>
                            <div class="rRight" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;right:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rLeft" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;left:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;top:-4px;left:50%;margin-left:-4px;"></div>
                            <div class="rDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;bottom:-4px;left:50%;margin-left:-4px;"></div>
                        </div>
                        <div class="drag" type="qr" index="2" style="z-index:2;left:100px;top:20px;width:80px;height:80px;position: absolute">
                            <img src="../../images/1.png" style="width:100%;height: 100%;"/>
                            <div class="rRightDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;right:-4px;bottom:-4px;"></div>
                            <div class="rLeftDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;left:-4px;bottom:-4px;"></div>
                            <div class="rRightUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;right:-4px;top:-4px;"></div>
                            <div class="rLeftUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;left:-4px;top:-4px;"></div>
                            <div class="rRight" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;right:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rLeft" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;left:-4px;top:50%;margin-top:-4px;"></div>
                            <div class="rUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;top:-4px;left:50%;margin-left:-4px;"></div>
                            <div class="rDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;bottom:-4px;left:50%;margin-left:-4px;"></div>
                        </div>
                    </div>
                    <ul class="poster_setting">
                        <li>
                            <div class="set_tit">背景图片</div>
                            <div class="set_msg">
                                <div class="bg_pic">
                                    <div id="remark"><span></span><input id="f" type="file" onchange="chooseImg(this)" style="opacity: 0;"></div>
                                    <label for="f" class="hb_pic">选择背景图</label>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="set_tit"></div>
                            <div class="set_msg">
                                <p class="tishi2" style="margin: 0">海报背景，最佳尺寸为：750*1600，大小建议500KB以下</p>
                            </div>
                        </li>
                        <li class="RewardType">
                            <div class="set_tit">海报元素</div>
                            <div class="set_msg hb_element">
                                <div class="radio_list">
                                    <label for="h_pic" class="checked" id="Uphoto_togg">
                                        <div class="chose">
                                            <input type="checkbox" checked name="pic2" id="h_pic">
                                            <span class="checked-bg"></span>
                                        </div>
                                        <span class="msg_set_txt">头像</span>
                                    </label>
                                    <label for="h_name" class="checked" id="Name_togg">
                                        <div class="chose">
                                            <input type="checkbox" checked name="pic2" id="h_name">
                                            <span class="checked-bg"></span>
                                        </div>
                                        <span class="msg_set_txt">昵称</span>
                                    </label>
                                    <!--   默认就有，且必须要   -->
                                    <label for="h_qr" class="checked" style="cursor: no-drop;opacity: .6">
                                        <div class="chose">
                                            <input type="checkbox" checked disabled name="pic2" id="h_qr">
                                            <span class="checked-bg"></span>
                                        </div>
                                        <span class="msg_set_txt">二维码</span>
                                    </label>
                                </div>
                            </div>
                        </li>
                        <li class="name_msg active">
                            <div class="set_tit">昵称颜色</div>
                            <div class="set_msg">
                                <div class="fontSize_color">
                                    <span>#666666</span>       <!--  选择颜色后 要把 RGB格式 转换为 HEX 格式  -->
                                    <label for="onchange" onclick="rgb2hex()"></label>
                                    <input type="color" id="onchange" style="display: none"/>
                                </div>
                            </div>
                        </li>
                        <li class="name_msg active">
                            <div class="set_tit">昵称大小</div>
                            <div class="set_msg">
                                <div class="select-text fontSize">
                                    <span class="select-txt">12</span>
                                    <ul style="display: none;">
                                        <li>12</li>
                                        <li>14</li>
                                        <li>16</li>
                                        <li>18</li>
                                        <li>20</li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                        <li class="hpic_msg" style="display: flex;">
                            <div class="set_tit">头像形状</div>
                            <div class="set_msg">
                                <ul class="head_style">
                                    <li class="square">
                                        <label for="squ" class="radio">
                                            <div class="chose">
                                                <input type="radio" checked name="statu" id="squ" />
                                                <span class="checked-bg"></span>
                                            </div>
                                            <span class="msg_set_txt">方形</span>
                                        </label>
                                    </li>
                                    <li class="circle">
                                        <label for="cir" class="radio">
                                            <div class="chose">
                                                <input type="radio" name="statu" id="cir" />
                                                <span class="checked-bg"></span>
                                            </div>
                                            <span class="msg_set_txt">圆形</span>
                                        </label>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="btn-list2"><span class="btn btn-sure">保存</span></div>
</div>



<script src="../../js/jquery.min.js"></script>
<script src="../../js/layui/layui.js"></script>
<script src="../../js/layui/lay/modules/layer.js"></script>
<script src="../../js/designer.js"></script>
<script src="../../js/myjs.js"></script>
<!--海报设置js-->
<script>
    $(function(){
        $('.circle').click(function(){
            $('.u_pic > img').css('border-radius','50%')
        });
        $('.square').click(function(){
            $('.u_pic > img').css('border-radius','0')
        });
        $('.fontSize li').click(function(){
            $('.u_name .text').css('fontSize',$(this).text()+'px');
            $('.fontSize_name span').text($(this).text());
        });
        $('#Uphoto_togg input').click(function(){
            $('#h_pic').attr("checked",true);
            $(this).find('.checked-bg').toggleClass('on');
            $('.hpic_msg').toggle();
            $('#squ').attr("checked",true);
            $('#cir').attr("checked",false);
            if($('#h_pic').is(':checked')){
                $('.u_pic').remove();
                $('#poster').append( '<div class="drag u_pic" type="head" index="3" style="z-index:3;left:20px;top:20px;width:60px;height:60px;position: absolute">'+
                    '<img src="../../images/head.jpg" style="position:absolute;z-index:0;width:100%;height: 100%"/>'+
                    '<div class="rRightDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;right:-4px;bottom:-4px;"></div>'+
                    '<div class="rLeftDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;left:-4px;bottom:-4px;"></div>'+
                    '<div class="rRightUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;right:-4px;top:-4px;"></div>'+
                    '<div class="rLeftUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;left:-4px;top:-4px;"></div>'+
                    '<div class="rRight" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;right:-4px;top:50%;margin-top:-4px;"></div>'+
                    '<div class="rLeft" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;left:-4px;top:50%;margin-top:-4px;"></div>'+
                    '<div class="rUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;top:-4px;left:50%;margin-left:-4px;"></div>'+
                    '<div class="rDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;bottom:-4px;left:50%;margin-left:-4px;"></div>'+
                    '</div>');
                $(function(){
                    $('.drag').each(function(){
                        bindEvents($(this));
                    });
                });
                $('.u_pic > img').css('border-radius','0');
            }else{
                $('.u_pic').remove();
            }
        });
        $('#Name_togg input').click(function(){
            $('#h_name').attr("checkbox",true);
            $(this).find('.checked-bg').toggleClass('on');
            $('.name_msg').toggleClass('active');
            if($('#h_name').is(':checked')){
                $('.u_name').remove();
                $('#poster').append( '<div  class="drag u_name" id="u_name" type="realname" index="4" style="z-index:4;right:20px;top:20px;width:60px;height:21px;position: absolute">'+
                    '<div class="text">昵称</div>'+
                    '<div class="rRightDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;right:-4px;bottom:-4px;"></div>'+
                    '<div class="rLeftDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;left:-4px;bottom:-4px;"></div>'+
                    '<div class="rRightUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:ne-resize;right:-4px;top:-4px;"></div>'+
                    '<div class="rLeftUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:nw-resize;left:-4px;top:-4px;"></div>'+
                    '<div class="rRight" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;right:-4px;top:50%;margin-top:-4px;"></div>'+
                    '<div class="rLeft" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:e-resize;left:-4px;top:50%;margin-top:-4px;"></div>'+
                    '<div class="rUp" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;top:-4px;left:50%;margin-left:-4px;"></div>'+
                    '<div class="rDown" style="position:absolute;background: #00cc19;width:7px;height:7px;z-index:1;font-size:0;cursor:n-resize;bottom:-4px;left:50%;margin-left:-4px;"></div>'+
                    '</div>');
                $(function(){
                    $('.drag').each(function(){
                        bindEvents($(this));
                    });
                })
            }else{
                $('.u_name').remove();
            }
        });
    });
    function colorRGB2Hex(color) {
        var rgb = color.split(',');
        var r = parseInt(rgb[0].split('(')[1]);
        var g = parseInt(rgb[1]);
        var b = parseInt(rgb[2].split(')')[0]);
        var hex = "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        return hex;
    }
    document.getElementById('onchange').onchange = function(){
        document.getElementById('onchange').click();
        document.getElementById('u_name').style.color = this.value;
        var link_col=$('.u_name').css('color');
        var sHexColor = colorRGB2Hex(link_col);
        $('.fontSize_color label').css('background-color',link_col);
        $('.fontSize_color span').text(sHexColor)
    };
    function chooseImg(file){
        var file=file.files[0];
        var reader=new FileReader();
        reader.readAsDataURL(file);
        reader.onload=function(){
            var img=document.getElementById('Img');
            img.src=this.result;
        };
    }
    $("input[type=file]").change(function(){
        var str=$(this).val();
        if(str!==""){
            var arr=str.split("\\");
            var file_name=arr[arr.length-1];
            $('#remark span').text(file_name);
        }
    });
</script>
<!-- 拖动缩放 -->
<script language='javascript'>
    $('form').submit(function(){
        $('.drag').each(function(){
            var obj = $(this);
            var type = obj.attr('type');
            var left = obj.css('left'),top = obj.css('top');
            var d= {left:left,top:top,type:obj.attr('type'),width:obj.css('width'),height:obj.css('height'),radius:obj.css('border-radius')};
            if(type=='realname' ||type=='title' || type=='marketprice' || type=='productprice'){
                d.size = obj.attr('size');
                d.color = obj.attr('color');
            } else if(type=='qr'){
                d.size = obj.attr('size');
            } else if(type=='img'){
                d.src = obj.attr('src');
            }else if(type=='head'){
                d.radius = obj.attr('border-radius');
            } else if(type=='fimg'){
                d.size = obj.attr('size');
            }//粉丝
            data.push(d);
        });
    });
    function bindEvents(obj){
        var index = obj.attr('index');
        var rs = new Resize(obj, { Max: true, mxContainer: "#poster" });
        rs.Set($(".rRightDown",obj), "right-down");
        rs.Set($(".rLeftDown",obj), "left-down");
        rs.Set($(".rRightUp",obj), "right-up");
        rs.Set($(".rLeftUp",obj), "left-up");
        rs.Set($(".rRight",obj), "right");
        rs.Set($(".rLeft",obj), "left");
        rs.Set($(".rUp",obj), "up");
        rs.Set($(".rDown",obj), "down");
        rs.Scale = true;
        var type = obj.attr('type');
        if(type=='realname' || type=='img' || type=='title' || type=='marketprice' || type=='productprice' || type=='fimg'){
            rs.Scale = false;
        }
        new Drag(obj, { Limit: true, mxContainer: "#poster" });
        $('.drag .remove').unbind('click').click(function(){
            $(this).parent().remove();
        })

        obj.unbind('click').click(function(){
            bind($(this));
        })
    }
    var imgsettimer = 0 ;
    var nametimer = 0;
    var headsettimer = 0;
    var bgtimer = 0 ;
    function bindType(type){
        $("#goodsparams").hide();
        $(".type4").hide();
        if(type=='4'){
            $(".type4").show();
        } else if(type=='3'){
            $("#goodsparams").show();
        }
    }
    function clearTimers(){
        clearInterval(imgsettimer);
        clearInterval(nametimer);
        clearInterval(bgtimer);
        clearInterval(headsettimer);
    }
    function bind(obj){
        var imgset = $('#imgset'), nameset = $("#nameset"),qrset = $('#qrset'),headset =$("#headset"),fimgset =$("#fimgset");
        imgset.hide();nameset.hide();headset.hide();qrset.hide();fimgset.hide();
        clearTimers();
        var type = obj.attr('type');
        if(type=='realname' || type=='title' || type=='marketprice' || type=='productprice'){
            nameset.show();
            var color = obj.attr('color') || "#000";
            var size = obj.attr('size') || "12";
            var input = nameset.find('input:first');
            var namesize = nameset.find('#namesize');
            var picker = nameset.find('.sp-preview-inner');
            input.val(color); namesize.val(size.replace("pt",""));
            picker.css( {'background-color':color,'font-size':size});
            nametimer = setInterval(function(){
                obj.attr('color',input.val()).find('.text').css('color',input.val());
                obj.attr('size',namesize.val() +"pt").find('.text').css('font-size',namesize.val() +"pt");
            },100);
        } else if(type=='qr'){
            qrset.show();
            var size = obj.attr('size') || "3";
            var sel = qrset.find('#qrsize');
            sel.val(size);

            sel.unbind('change').change(function(){
                obj.attr('size',sel.val())
            });
        }else if(type=='head'){
            headset.show();
            var radius= obj.attr('border-radius') || "0px";

            var head_shape_checked=headset.find("#head_shape_val");
            $("input:radio[name='head_shape']").each(function(){
                if($(this).val()==radius){
                    $(this).prop("checked",true);
                }else{
                    $(this).prop("checked",false);
                }
            })

            head_shape_checked.val(radius);
            headsettimer = setInterval(function() {
                obj.attr('border-radius', head_shape_checked.val());
                obj.find('img').css('border-radius', head_shape_checked.val());
            },100);
        } else if(type=='fimg'){
            fimgset.show();
            var size = obj.attr('size') || "3";
            var sel = fimgset.find('#fimgset');
            sel.val(size);

            sel.unbind('change').change(function(){
                obj.attr('size',sel.val())
            });
        }
    }
    $(function(){
        $('.drag').each(function(){
            bindEvents($(this));
        });
    })
</script>
</body>
</html>